<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ø¨Ø·Ù„ ØªØ¹Ø±ÙŠØµ</title>

<style>
*{
  box-sizing:border-box;
  font-family: system-ui, -apple-system, BlinkMacSystemFont;
}
body{
  margin:0;
  background:linear-gradient(135deg,#0f2027,#203a43,#2c5364);
  color:#fff;
  min-height:100vh;
  display:flex;
  flex-direction:column;
}
h1,h2,h3{
  text-align:center;
}
button{
  background:#00ffc8;
  border:none;
  padding:14px;
  border-radius:12px;
  font-size:16px;
  font-weight:bold;
  cursor:pointer;
}
button:active{transform:scale(0.97);}
input,select{
  width:100%;
  padding:12px;
  border-radius:10px;
  border:none;
  margin-bottom:10px;
}
.screen{
  display:none;
  padding:20px;
  flex:1;
}
.screen.active{
  display:block;
}
.card{
  background:rgba(255,255,255,0.1);
  backdrop-filter: blur(10px);
  border-radius:20px;
  padding:20px;
  margin-bottom:15px;
}
.footer{
  text-align:center;
  font-size:13px;
  opacity:0.7;
  padding:10px;
}
.list button{
  width:100%;
  margin-bottom:8px;
}
.countdown{
  font-size:50px;
  text-align:center;
  margin-top:30px;
}
</style>
</head>

<body>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ø¨Ø¯Ø§ÙŠØ© -->
<div class="screen active" id="startScreen">
  <h1>ğŸ”¥ Ø¨Ø·Ù„ ØªØ¹Ø±ÙŠØµ ğŸ”¥</h1>
  <div class="card">
    <input id="playerName" placeholder="Ø§Ø³Ù… Ø§Ù„Ù„Ø§Ø¹Ø¨">
    <button onclick="addPlayer()">Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨</button>
    <div id="playersList"></div>
  </div>

  <div class="card">
    <select id="category">
      <option value="">Ø§Ø®ØªØ± Ø§Ù„ÙØ¦Ø©</option>
      <option value="players">Ø£Ø³Ù…Ø§Ø¡ Ù„Ø§Ø¹Ø¨ÙŠÙ†</option>
      <option value="clothes">Ù…Ù„Ø§Ø¨Ø³</option>
      <option value="food">Ø·Ø¹Ø§Ù…</option>
      <option value="drinks">Ù…Ø´Ø±ÙˆØ¨Ø§Øª</option>
    </select>
    <button onclick="startGame()">Ø§Ø¨Ø¯Ø£ Ø§Ù„Ø¬ÙŠÙ…</button>
  </div>
</div>

<!-- Ø´Ø§Ø´Ø© ÙƒØ´Ù Ø§Ù„Ø£Ø¯ÙˆØ§Ø± -->
<div class="screen" id="revealScreen">
  <h2 id="revealText"></h2>
  <button onclick="nextReveal()">Ø§Ù„ØªØ§Ù„ÙŠ</button>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„Ù†Ù‚Ø§Ø´ -->
<div class="screen" id="discussionScreen">
  <h2>Ù†Ø§Ù‚Ø´ÙˆØ§ Ù…ÙŠÙ† Ø§Ù„Ø¹Ø±Øµ ğŸ¤¨</h2>
  <p style="text-align:center">Ù„Ù…Ø§ ØªØ®Ù„ØµÙˆØ§ Ø§Ø¶ØºØ·ÙˆØ§ Ø§Ù„Ø²Ø±</p>
  <button onclick="startVoting()">Ø¹Ø±ÙÙ†Ø§ Ù…ÙŠÙ† Ø§Ù„Ø¬Ø§Ø³ÙˆØ³</button>
</div>

<!-- Ø´Ø§Ø´Ø© Ø§Ù„ØªØµÙˆÙŠØª -->
<div class="screen" id="voteScreen">
  <h2 id="voteTitle"></h2>
  <div class="list" id="voteList"></div>
</div>

<!-- Ø§Ù„Ø¹Ø¯ Ø§Ù„ØªÙ†Ø§Ø²Ù„ÙŠ -->
<div class="screen" id="countdownScreen">
  <div class="countdown" id="countdown">3</div>
</div>

<!-- Ø§Ù„Ù†ØªÙŠØ¬Ø© -->
<div class="screen" id="resultScreen">
  <h2 id="resultText"></h2>
  <div id="spyGuess"></div>
</div>

<div class="footer">
Â© Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø­Ù‚ÙˆÙ‚ Ù…Ø­ÙÙˆØ¸Ø© Ù„Ø¯Ù‰ HOMOS
</div>

<script>
/* ===== Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª ===== */
const words = {
  players:["Ù…ÙŠØ³ÙŠ","Ø±ÙˆÙ†Ø§Ù„Ø¯Ùˆ","ØµÙ„Ø§Ø­","Ù†ÙŠÙ…Ø§Ø±","Ø²ÙŠØ¯Ø§Ù†","Ø¥Ù†ÙŠÙŠØ³ØªØ§"],
  clothes:["ØªÙŠØ´ÙŠØ±Øª","Ø¬Ø§ÙƒÙŠØª","Ø¨Ù†Ø·Ù„ÙˆÙ†","Ø­Ø°Ø§Ø¡","ÙƒØ§Ø¨"],
  food:["Ø¨ÙŠØªØ²Ø§","ÙƒØ´Ø±ÙŠ","Ø¨Ø±Ø¬Ø±","Ù…Ø­Ø´ÙŠ","Ø´Ø§ÙˆØ±Ù…Ø§"],
  drinks:["Ù‚Ù‡ÙˆØ©","Ø´Ø§ÙŠ","Ø¨ÙŠØ¨Ø³ÙŠ","Ø¹ØµÙŠØ±","Ù†Ø³ÙƒØ§ÙÙŠÙ‡"]
};

let players=[];
let spyIndex=0;
let word="";
let revealIndex=0;
let votes={};

/* ===== Ø£Ø¯ÙˆØ§Øª ===== */
function show(id){
  document.querySelectorAll('.screen').forEach(s=>s.classList.remove('active'));
  document.getElementById(id).classList.add('active');
}

/* ===== Ø¥Ø¶Ø§ÙØ© Ù„Ø§Ø¹Ø¨ ===== */
function addPlayer(){
  const input=document.getElementById("playerName");
  if(!input.value) return;
  players.push(input.value);
  input.value="";
  renderPlayers();
}
function renderPlayers(){
  const div=document.getElementById("playersList");
  div.innerHTML="";
  players.forEach(p=>{
    div.innerHTML+=`<div class="card">${p}</div>`;
  });
}

/* ===== Ø¨Ø¯Ø¡ Ø§Ù„Ù„Ø¹Ø¨Ø© ===== */
function startGame(){
  if(players.length<3) return alert("Ù„Ø§Ø²Ù… 3 Ù„Ø§Ø¹Ø¨ÙŠÙ† Ø¹Ù„Ù‰ Ø§Ù„Ø£Ù‚Ù„");
  const cat=document.getElementById("category").value;
  if(!cat) return alert("Ø§Ø®ØªØ§Ø± ÙØ¦Ø©");
  spyIndex=Math.floor(Math.random()*players.length);
  word=words[cat][Math.floor(Math.random()*words[cat].length)];
  revealIndex=0;
  saveGame();
  showReveal();
}

/* ===== Ø­ÙØ¸ Ù…Ø­Ù„ÙŠ 5 Ø¯Ù‚Ø§ÙŠÙ‚ ===== */
function saveGame(){
  localStorage.setItem("bt_game",JSON.stringify({
    players,spyIndex,word,time:Date.now()
  }));
}
function loadGame(){
  const g=JSON.parse(localStorage.getItem("bt_game"));
  if(!g) return false;
  if(Date.now()-g.time>5*60*1000){
    localStorage.removeItem("bt_game");
    return false;
  }
  players=g.players;
  spyIndex=g.spyIndex;
  word=g.word;
  return true;
}

/* ===== ÙƒØ´Ù Ø§Ù„Ø£Ø¯ÙˆØ§Ø± ===== */
function showReveal(){
  show("revealScreen");
  const name=players[revealIndex];
  const text = revealIndex===spyIndex
    ? `${name} Ø£Ù†Øª Ø§Ù„Ø¹Ø±Øµ ğŸ¤¡`
    : `${name} Ø§Ù„ÙƒÙ„Ù…Ø© Ù‡ÙŠ: ${word}`;
  document.getElementById("revealText").innerText=text;
}
function nextReveal(){
  revealIndex++;
  if(revealIndex>=players.length){
    show("discussionScreen");
  }else{
    showReveal();
  }
}

/* ===== Ø§Ù„ØªØµÙˆÙŠØª ===== */
function startVoting(){
  votes={};
  voteTurn(0);
}
function voteTurn(i){
  if(i>=players.length){
    startCountdown();
    return;
  }
  show("voteScreen");
  document.getElementById("voteTitle").innerText=`${players[i]} Ø´Ø§ÙƒÙƒ ÙÙŠ Ù…ÙŠÙ†ØŸ`;
  const list=document.getElementById("voteList");
  list.innerHTML="";
  players.forEach(p=>{
    if(p!==players[i]){
      const b=document.createElement("button");
      b.innerText=p;
      b.onclick=()=>{votes[i]=p;voteTurn(i+1);}
      list.appendChild(b);
    }
  });
}

/* ===== Ø¹Ø¯ ØªÙ†Ø§Ø²Ù„ÙŠ ===== */
function startCountdown(){
  show("countdownScreen");
  let c=3;
  const el=document.getElementById("countdown");
  el.innerText=c;
  const t=setInterval(()=>{
    c--;
    el.innerText=c;
    if(c===0){
      clearInterval(t);
      showResult();
    }
  },1000);
}

/* ===== Ø§Ù„Ù†ØªÙŠØ¬Ø© ===== */
function showResult(){
  show("resultScreen");
  document.getElementById("resultText").innerText=
    `Ø§Ù„Ø¹Ø±Øµ Ù‡Ùˆ: ${players[spyIndex]}`;
  const div=document.getElementById("spyGuess");
  div.innerHTML="<h3>Ø§Ø®ØªØ§Ø± Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„ØµØ­:</h3>";
  const options=[word];
  while(options.length<4){
    const w=Object.values(words).flat()
      .filter(x=>x!==word)[Math.floor(Math.random()*10)];
    if(!options.includes(w)) options.push(w);
  }
  options.sort(()=>Math.random()-0.5);
  options.forEach(o=>{
    const b=document.createElement("button");
    b.innerText=o;
    b.onclick=()=>{
      alert(o===word?"ğŸ‘ Ø§Ù„Ø¹Ø±Øµ ÙƒØ³Ø¨":"ğŸ˜‚ Ø§Ù„Ø¹Ø±Øµ Ø®Ø³Ø±");
      localStorage.removeItem("bt_game");
      location.reload();
    };
    div.appendChild(b);
  });
}

/* ===== ØªØ­Ù…ÙŠÙ„ ØªÙ„Ù‚Ø§Ø¦ÙŠ ===== */
if(loadGame()){
  show("discussionScreen");
}
</script>

</body>
</html>
